$Revision: 26 $

//======================================================================//
//　xk肢用のO定
//======================================================================//
//======================================================================//
.//■xk肢
//======================================================================//
//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//
..//２kのxk肢ボタンを表示
//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//
...//２kのxk肢ボタンを表示
function SetChoice02($テキストデ`タ１,$テキストデ`タ２)
{
	//xk肢の数は何？
	$SetChoiceNum=2;
	//すべてのO定
	SetChoiceBase();
}
...//２kの１番目がxばれた後のI理
function ChoiceA02()
{
	//xk肢は何？
	$SetChoiceSelect=0;
	//xk肢幼
	ChoiceFade();
}
...//２kの２番目がxばれた後のI理
function ChoiceB02()
{
	//xk肢は何？
	$SetChoiceSelect=1;
	//xk肢幼
	ChoiceFade();
}
//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//
..//３kのxk肢ボタンを表示
//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//
...//３kのxk肢ボタンを表示
function SetChoice03($テキストデ`タ１,$テキストデ`タ２,$テキストデ`タ３)
{
	//xk肢の数は何？
	$SetChoiceNum=3;
	//すべてのO定
	SetChoiceBase();
}
...//３kの１番目がxばれた後のI理
function ChoiceA03()
{
	//xk肢は何？
	$SetChoiceSelect=0;
	//xk肢幼
	ChoiceFade();
}
...//３kの２番目がxばれた後のI理
function ChoiceB03()
{
	//xk肢は何？
	$SetChoiceSelect=1;
	//xk肢幼
	ChoiceFade();
}
...//３kの３番目がxばれた後のI理
function ChoiceC03()
{
	//xk肢は何？
	$SetChoiceSelect=2;
	//xk肢幼
	ChoiceFade();
}
//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//
..//４kのxk肢ボタンを表示
//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//
...//４kのxk肢ボタンを表示
function SetChoice04($テキストデ`タ１,$テキストデ`タ２,$テキストデ`タ３,$テキストデ`タ４)
{
	//xk肢の数は何？
	$SetChoiceNum=4;
	//すべてのO定
	SetChoiceBase();
}
...//４kの１番目がxばれた後のI理
function ChoiceA04()
{
	//xk肢は何？
	$SetChoiceSelect=0;
	//xk肢幼
	ChoiceFade();
}
...//４kの２番目がxばれた後のI理
function ChoiceB04()
{
	//xk肢は何？
	$SetChoiceSelect=1;
	//xk肢幼
	ChoiceFade();
}
...//４kの３番目がxばれた後のI理
function ChoiceC04()
{
	//xk肢は何？
	$SetChoiceSelect=2;
	//xk肢幼
	ChoiceFade();
}
...//４kの４番目がxばれた後のI理
function ChoiceD04()
{
	//xk肢は何？
	$SetChoiceSelect=3;
	//xk肢幼
	ChoiceFade();
}
//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//
..//５kのxk肢ボタンを表示
//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//
...//５kのxk肢ボタンを表示
function SetChoice05($テキストデ`タ１,$テキストデ`タ２,$テキストデ`タ３,$テキストデ`タ４,$テキストデ`タ５)
{
	//xk肢の数は何？
	$SetChoiceNum=5;
	//すべてのO定
	SetChoiceBase();
}
...//５kの１番目がxばれた後のI理
function ChoiceA05()
{
	//xk肢は何？
	$SetChoiceSelect=0;
	//xk肢幼
	ChoiceFade();
}
...//５kの２番目がxばれた後のI理
function ChoiceB05()
{
	//xk肢は何？
	$SetChoiceSelect=1;
	//xk肢幼
	ChoiceFade();
}
...//５kの３番目がxばれた後のI理
function ChoiceC05()
{
	//xk肢は何？
	$SetChoiceSelect=2;
	//xk肢幼
	ChoiceFade();
}
...//５kの４番目がxばれた後のI理
function ChoiceD05()
{
	//xk肢は何？
	$SetChoiceSelect=3;
	//xk肢幼
	ChoiceFade();
}
...//５kの５番目がxばれた後のI理
function ChoiceE05()
{
	//xk肢は何？
	$SetChoiceSelect=4;
	//xk肢幼
	ChoiceFade();
}
//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//
..//６kのxk肢ボタンを表示
//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//
...//６kのxk肢ボタンを表示
function SetChoice06($テキストデ`タ１,$テキストデ`タ２,$テキストデ`タ３,$テキストデ`タ４,$テキストデ`タ５,$テキストデ`タ６)
{
	//xk肢の数は何？
	$SetChoiceNum=6;
	//すべてのO定
	SetChoiceBase();
}
...//６kの１番目がxばれた後のI理
function ChoiceA06()
{
	//xk肢は何？
	$SetChoiceSelect=0;
	//xk肢幼
	ChoiceFade();
}
...//６kの２番目がxばれた後のI理
function ChoiceB06()
{
	//xk肢は何？
	$SetChoiceSelect=1;
	//xk肢幼
	ChoiceFade();
}
...//６kの３番目がxばれた後のI理
function ChoiceC06()
{
	//xk肢は何？
	$SetChoiceSelect=2;
	//xk肢幼
	ChoiceFade();
}
...//６kの４番目がxばれた後のI理
function ChoiceD06()
{
	//xk肢は何？
	$SetChoiceSelect=3;
	//xk肢幼
	ChoiceFade();
}
...//６kの５番目がxばれた後のI理
function ChoiceE06()
{
	//xk肢は何？
	$SetChoiceSelect=4;
	//xk肢幼
	ChoiceFade();
}
...//６kの６番目がxばれた後のI理
function ChoiceF06()
{
	//xk肢は何？
	$SetChoiceSelect=5;
	//xk肢幼
	ChoiceFade();
}


//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//
..//xk肢用マクロ
//DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD//

...//xk肢における「前のxk肢にる」用
function SelectSave()
{
	#PreSaveFlag=true;
	Save(0);

	if(!$エキストラタイトル&&$GameName!="a0_01_01.nss"){
		$SYSTEM_mousewheel_up=false;
		$SYSTEM_mousewheel_down=false;
		Save(9999);
	}else{
		#PreSaveFlag=false;
	}
}

...//基本制御
function SetChoiceBase()
{
	$PLACE_select=true;
	#PreSaveFlag=true;

	$express_log=#SYSTEM_skip_express;
	$skip_log=$SYSTEM_skip;
	$auto_log=$SYSTEM_text_auto;

	$SYSTEM_menu_lock=true;
	$SYSTEM_backlog_lock = true;
	$SYSTEM_text_erase_lock = true;
	$SYSTEM_skip_lock = true;
	$SYSTEM_text_auto_lock = true;
	$SYSTEM_backselect_lock = true;

	//★ロックO置
	LockVideo(true);

	SetFont("@黑体", 20, #000000, #FFFFFF, 500, NULL);

	//■文字とデフォルト板
	LoadImage("select_img1","cg/sys/select/Select001.png");
	LoadImage("select_img2","cg/sys/select/Select002.png");
	LoadImage("select_img3","cg/sys/select/Select003.png");

	Array($ChoiceName,"xk肢１","xk肢２","xk肢３","xk肢４","xk肢５","xk肢６","xk肢７");
	AssocArray($ChoiceName,"xk肢１","xk肢２","xk肢３","xk肢４","xk肢５","xk肢６","xk肢７");

	Array($ChoiceNameText,$テキストデ`タ１,$テキストデ`タ２,$テキストデ`タ３,$テキストデ`タ４,$テキストデ`タ５,$テキストデ`タ６,$テキストデ`タ７);

	//等g隔算
	$SelectX_plus=100;
	//$SelectX=1024-(($SelectX_plus)*($SetChoiceNum-1)+50)/2;
	$SelectX=(($SelectX_plus)*($SetChoiceNum-2)+50)+1024/2;

	$SelectY="Middle";

	//■xk肢生成
	$LOCAL_last_text1=" ";
	$LOCAL_last_text2=" ";
	SetBacklog("　", "null", null);

	$ChoiceWhile=0;
	while($SetChoiceNum>$ChoiceWhile){
		CreateChoice($ChoiceName[$ChoiceWhile]);
		SetAlias($ChoiceName[$ChoiceWhile],$ChoiceName[$ChoiceWhile]);

		$choicenut=$ChoiceName[$ChoiceWhile]+"/MouseUsual/hit";
		CreateTexture($choicenut,30410,$SelectX,$SelectY,"select_img1");
		Request($choicenut,Erase);
		$choicenut=$ChoiceName[$ChoiceWhile]+"/MouseOver/hit";
		CreateTexture($choicenut, 30410,$SelectX,$SelectY,"select_img2");
	//	$choicenut=$ChoiceName[$ChoiceWhile]+"/MouseClick/hit";
	//	CreateTexture($choicenut,30400,$SelectX,$SelectY,"select_img3");
		$choicenut=$ChoiceName[$ChoiceWhile]+"/MouseClick";
		Delete($choicenut);

		$choicenut=$ChoiceName[$ChoiceWhile]+"/img1";
		CreateTexture($choicenut,30400,$SelectX,$SelectY,"select_img1");
		$choicenut=$ChoiceName[$ChoiceWhile]+"/img2";
		CreateTexture($choicenut,30410,$SelectX,$SelectY,"select_img3");

		$choicenut=$ChoiceName[$ChoiceWhile]+"/img1/txt";
		CreateText($choicenut,30411,inherit,inherit,auto,auto,$ChoiceNameText[$ChoiceWhile]);
		Request($choicenut,NoLog);
		Request($choicenut,PushText);
		Rotate($choicenut, 0, @0, @0, 90, null, false);
		Move($choicenut, 0, @-11, @0, null, false);

	//	$choicenut=$ChoiceName[$ChoiceWhile]+"/MouseOver/pro1";
	//	CreateProcess($choicenut, 30400, 0, 0, "SelectOpen1");
	//	$choicenut=$ChoiceName[$ChoiceWhile]+"/MouseOver/pro2";
	//	CreateProcess($choicenut, 30400, 0, 0, "SelectPause1");
	//	$choicenut=$ChoiceName[$ChoiceWhile]+"/MouseOver/se";
	//	CreateSound($choicenut, SE, "sound/se/SE_システム_タイトル_xk");

		//フォ`カス用位置：村正
		$choicenut=$ChoiceName[$ChoiceWhile]+"/MouseUsual/hit";
		Position($choicenut,$SelectPointX,$SelectPointY);

		VariableValue($,String("ChoiceArea%02dX",$ChoiceWhile),$SelectPointX);
		VariableValue($,String("ChoiceArea%02dY",$ChoiceWhile),$SelectPointY);
	
		$SelectH=$SelectPointX+50;
		VariableValue($,String("ChoiceArea%02dH",$ChoiceWhile),$SelectH);
		$SelectV=$SelectPointY+440;
		VariableValue($,String("ChoiceArea%02dV",$ChoiceWhile),$SelectV);
	
		if($ChoiceWhile==0){
			$MouseFirstX=$SelectPointX+25;
			$MouseFirstY=$SelectPointY+220;
		}
		if($ChoiceWhile==($SetChoiceNum-1)){
			$MouseLastX=$SelectPointX+25;
			$MouseLastY=$SelectPointY+220;
		}
	
		//ラストテキスト・バックログ登h
		$LOCAL_last_text1="『"+$ChoiceNameText[$ChoiceWhile]+"』";
		SetBacklog($LOCAL_last_text1, "null", null);//★バクログ

		$LOCAL_last_text2=$LOCAL_last_text2+"『"+$ChoiceNameText[$ChoiceWhile]+"』";

		//$SelectX+=$SelectX_plus;
		$SelectX-=$SelectX_plus;
		$ChoiceWhile++;
	}
	SetBacklog("　", "null", null);

	Fade("xk肢*/*",0,0,null,false);
	Fade("xk肢*/*/*",0,0,null,false);

	//CreateSound("xk肢Q定音", SE, "sound/se/SE_システム_タイトル_Q定");
	//SetAlias("xk肢Q定音","xk肢Q定音");

	//★ロック解除
	LockVideo(false);

	//フォ`カス
	ChoiceFocus();

	$SYSTEM_skip=false;
	$SYSTEM_text_auto=false;
	#SYSTEM_skip_express_minimum_time=0;

	if(!$エキストラタイトル){
		Save(9999);
	}
	if($GameName!="a0_01_01.nss"){
		$SYSTEM_menu_lock=false;
		Boxframe();
	}

	Fade("xk肢*/img1",500,1000,null,false);
	Fade("xk肢*/MouseUsual/*",500,1000,null,true);
	Draw();

	$LOCAL_keydown_left=false;
	$LOCAL_keydown_right=false;
	$LOCAL_keydown_up=false;
	$LOCAL_keydown_down=false;
	$LOCAL_mousewheel_up=false;
	$LOCAL_mousewheel_down=false;

	$SYSTEM_keydown_left=false;
	$SYSTEM_keydown_right=false;
	$SYSTEM_keydown_up=false;
	$SYSTEM_keydown_down=false;
	$SYSTEM_mousewheel_up=false;
	$SYSTEM_mousewheel_down=false;

	//★xk肢カ`ソル停止バグ用
	CursorPosition($X座诉xk,$Y座诉xk);
	$Y座诉xk+=5;
	MoveCursor($X座诉xk,$Y座诉xk);
	Wait(16);

	$SYSTEM_show_cursor = true;
	$SYSTEM_last_text = $LOCAL_last_text2;

	$SYSTEM_mousewheel_up=false;
	$SYSTEM_mousewheel_down=false;
}

...//■フォ`カス
function ChoiceFocus()
{
	$ChoiceMax=$SetChoiceNum;
	$ChoiceWhile=0;
	while($ChoiceMax>$ChoiceWhile){
		//次へ（下、右）
		$ChoiceNext=$ChoiceWhile+1;
		if($ChoiceNext>=$ChoiceMax){
			$ChoiceNext=0;
		}
		$nut1=$ChoiceName[$ChoiceWhile]+"/MouseUsual/hit";
		$nut2=$ChoiceName[$ChoiceNext]+"/MouseUsual/hit";
		SetNextFocus($nut1,$nut2,DOWN);
		SetNextFocus($nut1,$nut2,LEFT);
	
		//前へ（下、左）
		$ChoiceBack=$ChoiceWhile-1;
		if($ChoiceBack<0){
			$ChoiceBack=$ChoiceMax-1;
		}
		$nut1=$ChoiceName[$ChoiceWhile]+"/MouseUsual/hit";
		$nut2=$ChoiceName[$ChoiceBack]+"/MouseUsual/hit";
		SetNextFocus($nut1,$nut2,UP);
		SetNextFocus($nut1,$nut2,RIGHT);

		$ChoiceWhile++;
	}
}

...//■xk後I理
function ChoiceFade()
{
	SoundPlay("xk肢Q定音",0,1000,false);

	$choicenut=$ChoiceName[$SetChoiceSelect]+"/img2";
	Fade($choicenut,0,1000,null,false);
	$choicenut=$ChoiceName[$SetChoiceSelect]+"/img1";
	Fade($choicenut,0,0,null,false);
	$choicenut=$ChoiceName[$SetChoiceSelect]+"/img1/txt";
	Fade($choicenut,0,1000,null,false);
	Fade("*/MouseOver/hit",0,0,null,false);
	Wait(1000);
	Fade("*/img1",500,0,null,false);
	Fade("*/img2",500,0,null,false);

	WaitAction("@xk肢*");
	WaitAction("@xk肢*/*");
	WaitAction("@xk肢*/*/*");

	$テキストデ`タバックログ１="【"+$ChoiceNameText[$SetChoiceSelect]+"】";

	SetBacklog("　", "null", null);//★バクログ
	SetBacklog($テキストデ`タバックログ１, "null", null);//★バクログ
	SetBacklog("　", "null", null);//★バクログ

	Delete("xk*");
	Delete("@xk*");
	Delete("select_*");

	$SYSTEM_backlog_lock = false;
	$SYSTEM_skip_lock=false;
	$SYSTEM_text_auto_lock = false;
	$SYSTEM_show_cursor = false;
	$SYSTEM_text_erase_lock = false;
	if(!$エキストラタイトル){
		$SYSTEM_backselect_lock =false;
	}

	if(#keep_auto_and_skip){
		if($express_log){
			#SYSTEM_skip_express=$express_log;
		}

		if($skip_log){
			$SYSTEM_skip=true;
		}else if($auto_log){
			$SYSTEM_text_auto=true;
		}
	}

	$PLACE_select=false;
}


function ChoiceCursor(){
	$ChoiceOn=false;
	$ChoiceWhile=0;
	while($SetChoiceNum>$ChoiceWhile){
		$ChoiceUnderX1=VariableValue($,String("ChoiceArea%02dX",$ChoiceWhile));
		$ChoiceUnderX2=VariableValue($,String("ChoiceArea%02dH",$ChoiceWhile));
		$ChoiceUnderY1=VariableValue($,String("ChoiceArea%02dY",$ChoiceWhile));
		$ChoiceUnderY2=VariableValue($,String("ChoiceArea%02dV",$ChoiceWhile));

		if(($CsrX>$ChoiceUnderX1)&&($CsrX<$ChoiceUnderX2)&&($CsrY>$ChoiceUnderY1)&&($CsrY<$ChoiceUnderY2)){
			$ChoiceOn=true;
		}
		$ChoiceWhile++;
	}

	if(!$ChoiceOn){
		if($LOCAL_keydown_left){
			MoveCursor($MouseFirstX,$MouseFirstY);
		}else if($LOCAL_keydown_down){
			MoveCursor($MouseFirstX,$MouseFirstY);
		}else if($LOCAL_keydown_right){
			MoveCursor($MouseLastX,$MouseLastY);
		}else if($LOCAL_keydown_up){
			MoveCursor($MouseLastX,$MouseLastY);
		}else if($LOCAL_mousewheel_down){
			MoveCursor($MouseFirstX,$MouseFirstY);
		}else if($LOCAL_mousewheel_up){
			MoveCursor($MouseLastX,$MouseLastY);
		}
	}

	$LOCAL_keydown_left=false;
	$LOCAL_keydown_right=false;
	$LOCAL_keydown_up=false;
	$LOCAL_keydown_down=false;
	$LOCAL_mousewheel_up=false;
	$LOCAL_mousewheel_down=false;
//	Wait(16);
}

function ChoiceCursorSet(){
	if($SYSTEM_keydown_left){
		$LOCAL_keydown_left=true;
		ChoiceCursor();
	}else if($SYSTEM_keydown_right){
		$LOCAL_keydown_right=true;
		ChoiceCursor();
	}else if($SYSTEM_keydown_up){
		$LOCAL_keydown_up=true;
		ChoiceCursor();
	}else if($SYSTEM_keydown_down){
		$LOCAL_keydown_down=true;
		ChoiceCursor();
	}
}
